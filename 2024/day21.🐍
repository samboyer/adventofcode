"""
â˜€2ï¸âƒ£1ï¸âƒ£â•
"""

ğŸ§¼ = sorted
ğŸ–¨ = print
ğŸ¤ = zip
ğŸ‘† = abs
âœ… = True
âŒ = False

ğŸ›º = min
ğŸš› = max
ğŸ“ = len
ğŸ‘©â€ğŸŒ¾ = range
ğŸ—º = map
â• = sum
â›“ = list
ğŸ’ = set
âœ’ï¸  = lambda âœ–: str(âœ–)
ğŸª“ = lambda â­, âœ¨: â­.split(âœ¨)
ğŸ“¥ = lambda â›“, âœ¨: â›“.append(âœ¨)
ğŸ“¥ğŸ’ = lambda ğŸ’, âœ¨: ğŸ’.add(âœ¨)
ğŸ”¢ = lambda âœ–: int(âœ–)
â¯â­â“ = lambda â­, âœ¨: â­.startswith(âœ¨)

0ï¸âƒ£ = 0; 1ï¸âƒ£ = 1; 2ï¸âƒ£ = 2; 3ï¸âƒ£ = 3; 4ï¸âƒ£ = 4; 5ï¸âƒ£ = 5;
6ï¸âƒ£ = 6; 7ï¸âƒ£ = 7; 8ï¸âƒ£ = 8; 9ï¸âƒ£ = 9; ğŸ”Ÿ = 10
2ï¸âƒ£5ï¸âƒ£ = 25; 7ï¸âƒ£5ï¸âƒ£ = 75; 2ï¸âƒ£0ï¸âƒ£2ï¸âƒ£4ï¸âƒ£ = 2024; ğŸ’¯ = 100;
1ï¸âƒ£2ï¸âƒ£ = 12; 7ï¸âƒ£0ï¸âƒ£ = 70; 1ï¸âƒ£0ï¸âƒ£2ï¸âƒ£4ï¸âƒ£ = 1024

def ğŸ‘“(âœ):
    return [ğŸš£â€â™‚ï¸.strip() for ğŸš£â€â™‚ï¸ in open(âœ).readlines() if ğŸš£â€â™‚ï¸.strip()]

def ğŸ‘“ğŸ¤(âœ):
    return open(âœ).read()

def ğŸ’‰(â­, â†”, âœ¨):
    global 1ï¸âƒ£
    return â­[:â†”] + âœ¨ + â­[â†” + 1ï¸âƒ£:]

# ğŸŸ©ğŸŸ©ğŸŸ©ğŸ…¿1ï¸âƒ£ğŸŸ©ğŸŸ©ğŸŸ©

# ğŸ§¾ = ğŸ‘“('input/21.example.txt')
ğŸ§¾ = ğŸ‘“('input/21.txt')


ğŸ“±ğŸ“ = {
    '0': (1ï¸âƒ£, 3ï¸âƒ£),
    'A': (2ï¸âƒ£, 3ï¸âƒ£),
    '1': (0ï¸âƒ£, 2ï¸âƒ£),
    '2': (1ï¸âƒ£, 2ï¸âƒ£),
    '3': (2ï¸âƒ£, 2ï¸âƒ£),
    '4': (0ï¸âƒ£, 1ï¸âƒ£),
    '5': (1ï¸âƒ£, 1ï¸âƒ£),
    '6': (2ï¸âƒ£, 1ï¸âƒ£),
    '7': (0ï¸âƒ£, 0ï¸âƒ£),
    '8': (1ï¸âƒ£, 0ï¸âƒ£),
    '9': (2ï¸âƒ£, 0ï¸âƒ£),
}

â¡ğŸ“ = {
    '^': (1ï¸âƒ£, 0ï¸âƒ£),
    'A': (2ï¸âƒ£, 0ï¸âƒ£),
    '<': (0ï¸âƒ£, 1ï¸âƒ£),
    'v': (1ï¸âƒ£, 1ï¸âƒ£),
    '>': (2ï¸âƒ£, 1ï¸âƒ£),
}

def ğŸ‘©â€ğŸ³ğŸƒâ€â™€ï¸â›“(ğŸ—º, ğŸ¬, ğŸ¤–ğŸ“, ğŸ’¥ğŸ“):
    global ğŸ‘†,0ï¸âƒ£

    ğŸ‘£â›“â›“ = ['']
    for âœ– in ğŸ¬:
        ğŸ¥…ğŸ“ = ğŸ—º[âœ–]

        ğŸƒâ€â™€ï¸â†” = ğŸ¥…ğŸ“[0] - ğŸ¤–ğŸ“[0]
        ğŸƒâ€â™€ï¸â†• = ğŸ¥…ğŸ“[1] - ğŸ¤–ğŸ“[1]
        ğŸ‘£â†” = ('<' if (ğŸƒâ€â™€ï¸â†” < 0ï¸âƒ£) else '>') * ğŸ‘†(ğŸƒâ€â™€ï¸â†”)
        ğŸ‘£â†• = ('^' if (ğŸƒâ€â™€ï¸â†• < 0ï¸âƒ£) else 'v') * ğŸ‘†(ğŸƒâ€â™€ï¸â†•)

        ğŸƒâ€â™€ï¸â†”ğŸ“ = (ğŸ¤–ğŸ“[0]+ğŸƒâ€â™€ï¸â†”, ğŸ¤–ğŸ“[1])
        ğŸƒâ€â™€ï¸â†•ğŸ“ = (ğŸ¤–ğŸ“[0], ğŸ¤–ğŸ“[1]+ğŸƒâ€â™€ï¸â†•)

        if ğŸƒâ€â™€ï¸â†”ğŸ“ == ğŸ’¥ğŸ“:
            ğŸ‘£â›“â›“ = [ğŸ‘£â›“+ğŸ‘£â†•+ğŸ‘£â†”+'A' for ğŸ‘£â›“ in ğŸ‘£â›“â›“]
        elif ğŸƒâ€â™€ï¸â†•ğŸ“ == ğŸ’¥ğŸ“:
            ğŸ‘£â›“â›“ = [ğŸ‘£â›“+ğŸ‘£â†”+ğŸ‘£â†•+'A' for ğŸ‘£â›“ in ğŸ‘£â›“â›“]
        elif ğŸ‘£â†” and ğŸ‘£â†•:
            ğŸ‘£â›“â›“ = (
                [ğŸ‘£â›“+ğŸ‘£â†”+ğŸ‘£â†•+'A' for ğŸ‘£â›“ in ğŸ‘£â›“â›“] 
                + [ğŸ‘£â›“+ğŸ‘£â†•+ğŸ‘£â†”+'A' for ğŸ‘£â›“ in ğŸ‘£â›“â›“]
            )
        else:
            ğŸ‘£â›“â›“ = [ğŸ‘£â›“+ğŸ‘£â†”+ğŸ‘£â†•+'A' for ğŸ‘£â›“ in ğŸ‘£â›“â›“]

        ğŸ¤–ğŸ“ = ğŸ¥…ğŸ“
    return ğŸ‘£â›“â›“

ğŸ‰ = 0ï¸âƒ£

for ğŸ¬ in ğŸ§¾:
    ğŸ‘£â›“â›“1ï¸âƒ£ = ğŸ‘©â€ğŸ³ğŸƒâ€â™€ï¸â›“(ğŸ“±ğŸ“,ğŸ¬, (2ï¸âƒ£,3ï¸âƒ£), (0ï¸âƒ£,3ï¸âƒ£))
    ğŸ‘£â›“â›“2ï¸âƒ£ = []
    for ğŸ‘£â›“1ï¸âƒ£ in ğŸ‘£â›“â›“1ï¸âƒ£:
        ğŸ‘£â›“â›“2ï¸âƒ£ += ğŸ‘©â€ğŸ³ğŸƒâ€â™€ï¸â›“(â¡ğŸ“, ğŸ‘£â›“1ï¸âƒ£, (2ï¸âƒ£,0ï¸âƒ£), (0ï¸âƒ£,0ï¸âƒ£))

    ğŸ‘£â›“â›“3ï¸âƒ£ = []
    for ğŸ‘£â›“2ï¸âƒ£ in ğŸ‘£â›“â›“2ï¸âƒ£:
        ğŸ‘£â›“â›“3ï¸âƒ£ += ğŸ‘©â€ğŸ³ğŸƒâ€â™€ï¸â›“(â¡ğŸ“, ğŸ‘£â›“2ï¸âƒ£, (2ï¸âƒ£,0ï¸âƒ£), (0ï¸âƒ£,0ï¸âƒ£))

    ğŸ“â›“ = ğŸ—º(ğŸ“, ğŸ‘£â›“â›“3ï¸âƒ£)
    ğŸ¤ğŸ“ = ğŸ§¼(ğŸ“â›“)[0]

    âœ– = ğŸ”¢(ğŸ¬[:- 1ï¸âƒ£])
    ğŸ‰ += âœ– * ğŸ¤ğŸ“

ğŸ–¨(ğŸ‰)
