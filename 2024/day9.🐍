"""
â˜€9ï¸âƒ£â•
"""

ğŸ§¼ = sorted
ğŸ–¨ = print
ğŸ¤ = zip
ğŸ‘† = abs
âœ… = True
âŒ = False

ğŸ›º = min
ğŸš› = max
ğŸ“ = len
ğŸ‘©â€ğŸŒ¾ = range
ğŸ—º = map
â›“ = list
ğŸ’ = set
ğŸª“ = lambda â­, âœ¨: â­.split(âœ¨)
ğŸ“¥ = lambda â›“, âœ¨: â›“.append(âœ¨)
ğŸ“¥ğŸ’ = lambda ğŸ’, âœ¨: ğŸ’.add(âœ¨)
ğŸ”¢ = lambda âœ–: int(âœ–)

0ï¸âƒ£ = 0; 1ï¸âƒ£ = 1; 2ï¸âƒ£ = 2; 3ï¸âƒ£ = 3; 4ï¸âƒ£ = 4; 5ï¸âƒ£ = 5;
6ï¸âƒ£ = 6; 7ï¸âƒ£ = 7; 8ï¸âƒ£ = 8; 9ï¸âƒ£ = 9; ğŸ”Ÿ = 10


def ğŸ‘“(âœ):
    return [ğŸš£â€â™‚ï¸.strip() for ğŸš£â€â™‚ï¸ in open(âœ).readlines() if ğŸš£â€â™‚ï¸.strip()]

def ğŸ‘“ğŸ¤(âœ):
    return open(âœ).read()


# ğŸŸ©ğŸŸ©ğŸŸ©ğŸ…¿1ï¸âƒ£ğŸŸ©ğŸŸ©ğŸŸ©

ğŸ§¾ = ğŸ‘“ğŸ¤('input/9ï¸âƒ£.txt')

ğŸ’¿ = []
ğŸ“¦â“ = âœ…
for â¬‡ in ğŸ‘©â€ğŸŒ¾(ğŸ“(ğŸ§¾)):
    ğŸ†” = â¬‡//2
    for â¬‡â¬‡ in ğŸ‘©â€ğŸŒ¾(ğŸ”¢(ğŸ§¾[â¬‡])):
        ğŸ“¥(ğŸ’¿, ğŸ†” if ğŸ“¦â“ else '.')

    ğŸ“¦â“ = not ğŸ“¦â“

ğŸ”â“ = âœ…
â–¶ = 0
while ğŸ”â“:
    while ğŸ’¿[- 1ï¸âƒ£] == '.':
        ğŸ’¿.pop()

    ğŸ”â“ = âŒ
    for â¬‡ in ğŸ‘©â€ğŸŒ¾(â–¶, ğŸ“(ğŸ’¿)):
        if ğŸ’¿[â¬‡] == '.':
            â–¶ = â¬‡
            ğŸ’¿[â¬‡] = ğŸ’¿.pop()
            ğŸ”â“ = âœ…
            break

ğŸ‰ = 0
for â¬‡ in ğŸ‘©â€ğŸŒ¾(ğŸ“(ğŸ’¿)):
    ğŸ‰ += â¬‡ * ğŸ”¢(ğŸ’¿[â¬‡])

ğŸ–¨(ğŸ‰)